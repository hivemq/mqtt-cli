openapi: 3.0.1
info:
  title: HiveMQ Swarm REST API
  description: "\n# Introduction\n\nThe HiveMQ Swarm Commander REST API provides endpoints\
    \ for the following use cases:\n- Listing all scenarios\n- Adding a scenario\n\
    - Removing a scenario\n- Starting a scenario\n- Stopping a scenario\n\n## API\
    \ style\nThe Commanders's API is organized in a [RESTful](http://en.wikipedia.org/wiki/Representational_State_Transfer)\
    \ fashion.\n\nThe API has predictable resource-oriented URLs that consume and\
    \ return JSON with the content-type `application/json`.\nIt uses standard HTTP\
    \ response codes and verbs. All transfered scenarios are encoded with Base64.\n\
    \nThe base URL is the Host and configured port of your HiveMQ Swarm Commander.\n\
    \n## Errors\nConventional HTTP response codes are used to indicate the success\
    \ or failure of an API request.\nCodes in the 2xx range generally indicate success.\n\
    Codes in the 4xx range indicate an error that failed given the information provided\
    \ (e.g., a required parameter was omitted).\nCodes in the 5xx range indicate an\
    \ error on the server side.\n\nFor all user errors a JSON response with additional\
    \ details is returned in the format [Problem JSON](https://tools.ietf.org/html/rfc7807).\n\
    \n## OpenAPI\nThe HiveMQ Swarm Commander REST API provides an OpenAPI 3.0 schema\
    \ definition that\ncan be imported into popular API tooling (e.g. Postman) or\
    \ can be used to generate client-code for multiple programming languages.\n"
  contact:
    url: https://www.hivemq.com
  version: 4.6.0-RC2
  x-logo:
    url: https://www.hivemq.com/img/svg/hivemq-bee.svg
paths:
  /commander:
    get:
      tags:
      - Commander
      summary: Commander status
      description: "Commander status. \n\n This endpoint returns the current status\
        \ of the commander."
      operationId: getCommanderStatus
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommanderStateResponse'
              examples:
                commander-status:
                  summary: Commander status
                  description: Return commander status
                  value:
                    commander-status: READY
                    run-id: null
  /runs:
    get:
      tags:
      - Runs
      summary: List all runs.
      description: "List all runs \n\n This endpoint returns a list of all runs."
      operationId: listRuns
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListScenariosResponse'
              examples:
                list-runs:
                  summary: List runs
                  description: success
                  value:
                    runs:
                    - run-id: 1
                      scenario-id: 1
                      scenario-name: scenario
                      scenario-description: null
                      scenario-type: XML
                      run-status: FINISHED
                      scenario-stage: Stage with id 's3' (3/3).
    post:
      tags:
      - Runs
      summary: Start a run.
      description: "Start a run. \n\n This endpoint accepts runs."
      operationId: startRun
      requestBody:
        description: The scenario for the run.
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StartRunRequest'
            examples:
              start-run:
                summary: Start run
                description: The id of the scenario for the run
                value:
                  scenario-id: "1"
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StartRunResponse'
              examples:
                start-run:
                  summary: Start run.
                  description: Start run.
                  value:
                    run-id: 1
                    scenario-id: 1
                    scenario-name: scenario
                    scenario-description: null
                    scenario-type: XML
                    run-status: STARTING
        "409":
          description: Can not start run.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
              examples:
                start-run-failed:
                  summary: Start run failed.
                  description: Start run failed
                  value:
                    errors:
                    - title: Requested Resource Not Found.
                      detail: Scenario with id '2' was not found.
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
              examples:
                scenario-missing:
                  summary: Scenario field is missing
                  description: Bad request
                  value:
                    errors:
                    - title: Bad Request.
                      detail: Field 'scenario' is missing.
  /runs/{id}:
    get:
      tags:
      - Runs
      summary: Get a run.
      description: "Get a run. \n\n This endpoint returns the run and the associated\
        \ metadata."
      operationId: getRun
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RunResponse'
              examples:
                get-run-successful:
                  summary: Get run successful
                  description: Get run successful
                  value:
                    run-id: 1
                    scenario-id: 1
                    scenario-name: scenario
                    scenario-description: null
                    scenario-type: XML
                    run-status: FINISHED
                    scenario-stage: Stage with id 's3' (3/3).
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
              examples:
                run-not-found:
                  summary: Run was not found
                  description: Not Found
                  value:
                    errors:
                    - title: Requested Resource Not Found.
                      detail: Run with id '3' was not found.
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
              examples:
                id-invalid:
                  summary: Run id can not be parsed
                  description: Bad request
                  value:
                    errors:
                    - title: Bad Request.
                      detail: Id 'bad' is not an integer.
    delete:
      tags:
      - Runs
      summary: Delete a run.
      description: "Delete a run. \n\n This endpoint deletes the run with the associated\
        \ id if it exists and is not running."
      operationId: deleteRun
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        "204":
          description: Success
          content:
            application/json:
              examples:
                delete-run:
                  summary: Delete run
                  description: Delete run successful
        "409":
          description: Run in progress
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
              examples:
                run-in-progress:
                  summary: Run in progress can not be deleted.
                  description: Run in progress can not be deleted.
                  value:
                    errors:
                    - title: Can't delete run.
                      detail: Run with id '1' is in progress.
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
              examples:
                scenario-missing:
                  summary: Scenario was not found
                  description: Not Found
                  value:
                    errors:
                    - title: Requested Resource Not Found.
                      detail: Run with id '3' was not found.
    patch:
      tags:
      - Runs
      summary: Stop a run.
      description: "Stop a run. \n\n This operation stops runs by setting its status\
        \ to 'stopping'"
      operationId: stopRun
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        description: The new state of the run.
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StopRunRequest'
            examples:
              stop-run:
                summary: Stop run
                description: The new state of the run
                value:
                  run-status: STOPPING
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StopRunResponse'
              examples:
                stop-run:
                  summary: Stop run.
                  description: Stop run.
                  value:
                    run-id: 2
                    scenario-id: 1
                    scenario-name: scenario
                    scenario-description: null
                    scenario-type: XML
                    run-status: STOPPING
        "409":
          description: Can not stop run.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
              examples:
                stop-run-failed:
                  summary: Stop run failed.
                  description: Stop run failed
                  value:
                    errors:
                    - title: Can not stop run.
                      detail: Run with id '2' is not in progress.
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
              examples:
                run-missing:
                  summary: Run field is missing
                  description: Bad request
                  value:
                    errors:
                    - title: Bad Request.
                      detail: Field 'status' is missing.
  /scenarios:
    get:
      tags:
      - Scenarios
      summary: List all scenarios.
      description: "List all scenarios \n\n This endpoint returns a list of all scenarios."
      operationId: listScenarios
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListScenariosResponse'
              examples:
                list-scenarios:
                  summary: List scenarios
                  description: success
                  value:
                    scenarios:
                    - scenario-id: 1
                      scenario-name: scenario
                      scenario-description: null
                      scenario-type: XML
    post:
      tags:
      - Scenarios
      summary: Upload a scenario.
      description: "Upload a scenario. \n\n This endpoint accepts scenarios as Base64\
        \ strings and the respective metadata.Only valid scenarios can be uploaded."
      operationId: uploadScenario
      requestBody:
        description: The scenario to upload
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UploadScenarioRequest'
            examples:
              upload-scenario:
                summary: Upload scenario
                description: "The scenario to upload with a name, description, type\
                  \ and the xml/vm content encoded as Base64 string."
                value:
                  scenario-name: scenario
                  scenario-description: An awesome scenario
                  scenario-type: XML
                  scenario: BASE64==
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UploadScenarioResponse'
              examples:
                scenario-upload:
                  summary: Upload scenario
                  description: Upload scenario
                  value:
                    scenario-id: 1
                    scenario-name: scenario
                    scenario-description: null
                    scenario-type: XML
        "409":
          description: Can not upload scenario
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
              examples:
                scenario-upload-failed:
                  summary: Upload scenario failed
                  description: Upload scenario failed
                  value:
                    errors:
                    - title: Can not upload scenario.
                      detail: Scenario with name 'scenario' already exists
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
              examples:
                scenario-missing:
                  summary: Scenario field is missing
                  description: Bad request
                  value:
                    errors:
                    - title: Bad Request.
                      detail: Field 'scenario' is missing.
  /scenarios/{id}:
    get:
      tags:
      - Scenarios
      summary: Download a scenario.
      description: "Download a scenario. \n\n This endpoint returns the scenario as\
        \ Base64 string and the associated metadata."
      operationId: downloadScenario
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DownloadScenarioResponse'
              examples:
                download-upload-successful:
                  summary: Download scenario successful
                  description: Download scenario successful
                  value:
                    scenario-id: 1
                    scenario-name: scenario
                    scenario-description: null
                    scenario-type: XML
                    scenario: BASE64==
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
              examples:
                scenario-not-found:
                  summary: Scenario was not found
                  description: Not Found
                  value:
                    errors:
                    - title: Not Found.
                      detail: Scenario with id '4' was not found.
    delete:
      tags:
      - Scenarios
      summary: Delete a scenario.
      description: "Delete a scenario. \n\n This endpoint deletes the scenario with\
        \ the associated id."
      operationId: deleteScenario
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        "204":
          description: Success
          content:
            application/json:
              examples:
                delete-scenario:
                  summary: Delete scenario
                  description: Delete scenario successful
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
              examples:
                scenario-missing:
                  summary: Scenario was not found
                  description: Not Found
                  value:
                    errors:
                    - title: Not Found.
                      detail: Scenario with id '4' was not found.
components:
  schemas:
    CommanderStateResponse:
      type: object
      properties:
        commander-status:
          type: string
        run-id:
          type: string
    StartRunResponse:
      type: object
      properties:
        run-id:
          type: integer
          format: int32
        scenario-id:
          type: integer
          format: int32
        scenario-name:
          type: string
        scenario-description:
          type: string
        scenario-type:
          type: string
        run-status:
          type: string
    Errors:
      type: object
      properties:
        messages:
          type: array
          items:
            $ref: '#/components/schemas/Message'
    Message:
      type: object
      properties:
        message:
          type: string
        cause:
          type: object
          properties:
            stackTrace:
              type: array
              items:
                type: object
                properties:
                  classLoaderName:
                    type: string
                  moduleName:
                    type: string
                  moduleVersion:
                    type: string
                  methodName:
                    type: string
                  fileName:
                    type: string
                  lineNumber:
                    type: integer
                    format: int32
                  className:
                    type: string
                  nativeMethod:
                    type: boolean
            message:
              type: string
            suppressed:
              type: array
              items:
                type: object
                properties:
                  stackTrace:
                    type: array
                    items:
                      type: object
                      properties:
                        classLoaderName:
                          type: string
                        moduleName:
                          type: string
                        moduleVersion:
                          type: string
                        methodName:
                          type: string
                        fileName:
                          type: string
                        lineNumber:
                          type: integer
                          format: int32
                        className:
                          type: string
                        nativeMethod:
                          type: boolean
                  message:
                    type: string
                  localizedMessage:
                    type: string
            localizedMessage:
              type: string
        sources:
          type: array
          items:
            type: object
        source:
          type: string
    StartRunRequest:
      type: object
      properties:
        scenario-id:
          type: string
    StopRunResponse:
      type: object
      properties:
        run-id:
          type: integer
          format: int32
        scenario-id:
          type: integer
          format: int32
        scenario-name:
          type: string
        scenario-description:
          type: string
        scenario-type:
          type: string
        run-status:
          type: string
    StopRunRequest:
      type: object
      properties:
        run-status:
          type: string
    ListScenarioResponseEntry:
      type: object
      properties:
        scenario-id:
          type: integer
          format: int32
        scenario-name:
          type: string
        scenario-description:
          type: string
        scenario-type:
          type: string
    ListScenariosResponse:
      type: object
      properties:
        scenarios:
          type: array
          items:
            $ref: '#/components/schemas/ListScenarioResponseEntry'
    RunResponse:
      type: object
      properties:
        run-id:
          type: integer
          format: int32
        scenario-id:
          type: integer
          format: int32
        scenario-name:
          type: string
        scenario-description:
          type: string
        scenario-type:
          type: string
        run-status:
          type: string
        scenario-stage:
          type: string
    UploadScenarioResponse:
      type: object
      properties:
        scenario-id:
          type: integer
          format: int32
        scenario-name:
          type: string
        scenario-description:
          type: string
        scenario-type:
          type: string
    UploadScenarioRequest:
      type: object
      properties:
        scenario:
          type: string
        scenario-name:
          type: string
        scenario-description:
          type: string
        scenario-type:
          type: string
    DownloadScenarioResponse:
      type: object
      properties:
        scenario-id:
          type: integer
          format: int32
        scenario-name:
          type: string
        scenario-description:
          type: string
        scenario-type:
          type: string
        scenario:
          type: string
